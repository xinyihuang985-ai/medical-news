<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EBM-Agent åŒ»å­¦æ–‡çŒ®ç§‘ç ”åŠ¨æ€</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .sidebar { background-color: #f8fafc; border-right: 1px solid #e2e8f0; }
        .active-user-badge { background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); }
        .glass-card { background: white; border: 1px solid #f1f5f9; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05); }
        body { font-family: 'Inter', system-ui, -apple-system, sans-serif; }
    </style>
</head>
<body class="bg-[#f1f5f9] min-h-screen flex">

    <aside class="sidebar w-80 h-screen sticky top-0 flex flex-col p-6 overflow-y-auto shrink-0">
        <div class="flex items-center gap-3 mb-10">
            <div class="w-12 h-12 bg-blue-600 rounded-xl flex items-center justify-center text-white text-2xl shadow-lg">
                <i class="fas fa-stethoscope"></i>
            </div>
            <div>
                <h1 class="text-xl font-bold text-slate-800">EBM-Agent</h1>
                <p class="text-xs text-slate-500 font-medium">å¾ªè¯åŒ»å­¦ AI åŠ©æ‰‹</p>
            </div>
        </div>

        <div class="space-y-6">
            <section>
                <h3 class="text-xs font-semibold text-slate-400 uppercase tracking-wider mb-3">ğŸ“ å›¢é˜Ÿä»‹ç»</h3>
                <div class="bg-white rounded-lg p-4 text-sm text-slate-600 leading-relaxed shadow-sm border border-slate-100">
                    <p class="mb-2 font-medium text-slate-800">å¾ªè¯åŒ»å­¦å†³ç­–æ”¯æŒå›¢é˜Ÿ</p>
                    <p>è‡´åŠ›äºé€šè¿‡ LLM æŠ€æœ¯è‡ªåŠ¨åŒ– PubMed æ–‡çŒ®ç­›é€‰ä¸ä¸´åºŠä»·å€¼æŒ–æ˜ï¼Œä¸ºç§‘ç ”äººå‘˜æä¾› 48 å°æ—¶å†…çš„æé€Ÿç§‘ç ”ç®€æŠ¥ã€‚</p>
                </div>
            </section>

            <section>
                <h3 class="text-xs font-semibold text-slate-400 uppercase tracking-wider mb-3">âš™ï¸ æ•°æ®æ§åˆ¶</h3>
                <ul class="space-y-2">
                    <li class="flex items-center gap-2 text-sm text-blue-600 bg-blue-50 p-2 rounded cursor-pointer">
                        <i class="fas fa-file-lines w-4"></i> æ–‡çŒ®æ ¼å¼è¯´æ˜ä¹¦
                    </li>
                    <li id="status-tag" class="flex items-center gap-2 text-sm text-slate-600 p-2">
                        <i class="fas fa-circle-notch fa-spin w-4"></i> æ­£åœ¨åŒæ­¥äº‘ç«¯æ•°æ®
                    </li>
                </ul>
            </section>
        </div>

        <div class="mt-auto pt-10 text-[10px] text-slate-400 text-center uppercase tracking-widest">
            Â© 2026 EBM-Agent Labs
        </div>
    </aside>

    <main class="flex-1 p-10 overflow-y-auto">
        <header class="flex justify-between items-center mb-8">
            <div>
                <h2 class="text-2xl font-bold text-slate-800">ğŸ‘‹ æ¬¢è¿ï¼ä¸ºæ‚¨ç”Ÿæˆçš„åˆ†æç»“æœï¼š</h2>
                <p class="text-slate-500 mt-1">åŸºäºæ‚¨çš„ä¸ªäººè®¢é˜…åå¥½ï¼Œå·²æ£€ç´¢æœ€æ–° PubMed æ–‡çŒ®</p>
            </div>
            <div id="user-badge" class="active-user-badge text-white px-4 py-2 rounded-full text-xs font-bold shadow-md">
                ç”¨æˆ·: åŠ è½½ä¸­...
            </div>
        </header>

        <div id="content-list" class="grid grid-cols-1 gap-6">
            <div class="animate-pulse space-y-4">
                <div class="h-48 bg-slate-200 rounded-2xl"></div>
                <div class="h-48 bg-slate-200 rounded-2xl"></div>
            </div>
        </div>
    </main>

    <script>
        async function fetchResearch() {
            const urlParams = new URLSearchParams(window.location.search);
            const userId = urlParams.get('user'); // æ•è· URL ä¸­çš„ ?user= å‚æ•°
            const container = document.getElementById('content-list');
            const badge = document.getElementById('user-badge');
            const statusTag = document.getElementById('status-tag');

            if (!userId) {
                container.innerHTML = `<div class="p-10 text-center bg-white rounded-2xl border-2 border-dashed border-slate-200 text-slate-400">è¯·åœ¨ä¾§è¾¹æ é…ç½®ç”¨æˆ· ID æˆ–ä½¿ç”¨é“¾æ¥å‚æ•°è®¿é—®</div>`;
                badge.innerText = "æœªç™»å½•";
                return;
            }

            badge.innerText = `ID: ${userId.substring(0, 8)}...`;

            try {
                // æ ¸å¿ƒé€»è¾‘ï¼šä» data/ ç›®å½•ä¸‹è¯»å–å¯¹åº”çš„ json æ–‡ä»¶
                const response = await fetch(`./data/data_${userId}.json?cache_bust=${new Date().getTime()}`);
                if (!response.ok) throw new Error('æ–‡ä»¶æœªç”Ÿæˆ');
                
                const data = await response.json();
                
                statusTag.innerHTML = `<i class="fas fa-check-circle text-green-500 w-4"></i> æ•°æ®å·²å®æ—¶æ›´æ–°`;
                
                container.innerHTML = data.map(article => `
                    <div class="glass-card p-8 rounded-2xl border-l-8 border-l-blue-600">
                        <div class="flex justify-between items-start mb-4">
                            <h3 class="text-xl font-bold text-slate-800 leading-tight">${article.chinese_title || 'åŒ»å­¦åŠ¨æ€æ›´æ–°'}</h3>
                            <span class="text-xs font-bold text-slate-400 shrink-0 ml-4">${article.publish_date || '2026'}</span>
                        </div>
                        
                        <div class="bg-blue-50/50 p-4 rounded-xl mb-6">
                            <h4 class="text-xs font-bold text-blue-600 uppercase mb-2">ğŸ’¡ ä¸´åºŠä»·å€¼ç—›ç‚¹</h4>
                            <p class="text-slate-700 text-sm leading-relaxed italic">"${article.clinical_significance || 'æ­£åœ¨è§£æä¸´åºŠæ„ä¹‰...'}"</p>
                        </div>

                        <div class="text-slate-600 text-sm mb-6 leading-relaxed">
                            <strong class="text-slate-800 block mb-1">ğŸ” æ·±åº¦è§£æï¼š</strong>
                            ${article.deep_analysis || article.abstract || 'æ‘˜è¦å†…å®¹åŠ è½½ä¸­...'}
                        </div>

                        <div class="flex items-center justify-between border-t border-slate-100 pt-4">
                            <div class="flex gap-2 text-[10px] font-bold text-slate-400">
                                <span class="bg-slate-100 px-2 py-1 rounded">PUBMED ID: ${article.source_url ? article.source_url.split('/').pop() : 'N/A'}</span>
                                <span class="bg-slate-100 px-2 py-1 rounded">TYPE: SYSTEMATIC REVIEW</span>
                            </div>
                            <a href="${article.source_url}" target="_blank" class="text-blue-600 text-sm font-bold flex items-center gap-1 hover:underline">
                                è®¿é—®åŸæ–‡ <i class="fas fa-arrow-right-long text-xs"></i>
                            </a>
                        </div>
                    </div>
                `).join('');

            } catch (err) {
                container.innerHTML = `
                    <div class="p-10 text-center bg-blue-50 rounded-2xl border-2 border-dashed border-blue-200">
                        <div class="text-4xl mb-4 text-blue-400"><i class="fas fa-rocket fa-bounce"></i></div>
                        <h3 class="text-lg font-bold text-blue-800 mb-2">ğŸš€ AI æ­£åœ¨è¿è¡Œ NMA åˆ†æ</h3>
                        <p class="text-blue-600 text-sm">å·²è§¦å‘è‡ªåŠ¨åŒ–ä»»åŠ¡ï¼Œè¯·åœ¨ 1 åˆ†é’Ÿååˆ·æ–°é¡µé¢æŸ¥æ”¶ç»“æœã€‚</p>
                    </div>`;
                statusTag.innerHTML = `<i class="fas fa-hourglass-half text-amber-500 w-4"></i> æ­£åœ¨ç­‰å¾… AI ç”Ÿæˆç»“æœ`;
            }
        }

        fetchResearch();
    </script>
</body>
</html>
